!function(t,e){function i(t){return t&&("always"===t.embedded||"load"===t.embedded)}function r(t,e,r,s){var u=n(this,"attrs");u&&e.eachRelationship(function(e,n){var y=u[e];i(y)&&"hasMany"===n.kind&&a.call(this,t,e,n,r,s)},this)}function a(e,i,a,u,y){var l=e.serializerFor(a.type.typeKey),h=n(this,"primaryKey"),o="_"+t.String.pluralize(a.type.typeKey),c=this.keyForRelationship(i,a.kind),p=this.keyForAttribute(i),d=[];y[p]&&(u[o]=u[o]||[],s(y[p],function(t){var i=e.modelFor(a.type.typeKey);r.call(l,e,i,u,t),d.push(t[h]),u[o].push(t)}),y[c]=d,delete y[p])}var n=t.get,s=t.EnumerableUtils.forEach;e.HasManyEmbeddedRecordsMixin=t.Mixin.create({serializeHasMany:function(t,e,r){var a=r.key,s=this.get("attrs");if(!s||!i(s[a]))return this._super(t,e,r),void 0;var u=this.keyForAttribute(a);e[u]=n(t,a).map(function(t){var e=t.serialize(),i=n(this,"primaryKey");return e[i]=n(t,i),null===e.id&&delete e.id,e},this)},extractArray:function(e,i,a){var n=this.keyForAttribute(i.typeKey),u=a[t.String.pluralize(n)];return s(u,function(t){r.call(this,e,i,a,t)},this),this._super(e,i,a)},extractSingle:function(t,e,i,a,n){var s=this.keyForAttribute(e.typeKey),u=i[s];return r.call(this,t,e,i,u),this._super(t,e,i,a,n)}})}(Ember,DS);