!function(e,t){function i(t,n,s,y,u){var o=r(n,"attrs");o&&s.eachRelationship(function(n,s){var h,p,d,l,c=o[n],f=t.serializerFor(s.type.typeKey),b=r(f,"primaryKey");if("hasMany"===s.kind&&c&&("always"===c.embedded||"load"===c.embedded)){if(p="_"+e.String.pluralize(s.type.typeKey),h=this.keyForRelationship(n,s.kind),d=this.keyForAttribute(n),l=[],!y[d])return;u[p]=u[p]||[],a(y[d],function(e){var r=t.modelFor(s.type.typeKey);i(t,f,r,e,u),l.push(e[b]),u[p].push(e)}),y[h]=l,delete y[d]}},n)}var r=e.get,a=e.EnumerableUtils.forEach;t.EmbeddedRecordsMixin=e.Mixin.create({serializeHasMany:function(e,t,i){var a=i.key,n=r(this,"attrs"),s=n&&n[a]&&"always"===n[a].embedded;s&&(t[this.keyForAttribute(a)]=r(e,a).map(function(e){var t=e.serialize(),i=r(this,"primaryKey");return t[i]=r(e,i),t},this))},extractSingle:function(e,t,r,a,n){var s=this.keyForAttribute(t.typeKey),y=r[s];return i(e,this,t,y,r),this._super(e,t,r,a,n)},extractArray:function(t,r,n){var s=this.keyForAttribute(r.typeKey),y=n[e.String.pluralize(s)];return a(y,function(e){i(t,this,r,e,n)},this),this._super(t,r,n)}})}(Ember,DS);